<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Preparing the workbench</title>
  <link rel="stylesheet" href="../book.css" charset="ISO-8859-1"
 type="text/css">
  <meta http-equiv="Content-Type"
 content="text/html; charset=ISO-8859-1">
  <meta http-equiv="Content-Style-Type" content="text/css">
</head>
<body>
<h1> Prerequisites </h1>
<p> If you can debug your ruby application depends on the version of the
ruby interpreter you are using: </p>
<ul>
  <li><b>windows</b>. Only 1.6.8 (mswin32) works. 1.6.7 (mswin32) is
not sufficient. 1.8.0 is not yet supported. Other distributions than
mswin32 have not been tested. </li>
  <li><b>linux</b>.1.6.7 and 1.6.8 have been tested and work. 1.8.0 is
not yet supported. </li>
</ul>
<h1>Debugging your Application</h1>
<ol>
  <li>Open your ruby file and set a breakpoint like you would set a
breakpoint in a java file</li>
  <li>Select <b>Run &gt; Debug As &gt; Ruby Application.</b> The Debug
perspective will open:<br>
    <img src="../../images/debug.png" title="" alt="debug screenshot"
 style="width: 788px; height: 540px;"> </li>
  <li> In the launch view use <b>step into, step over, step return</b>
to step through the code. Use the <span style="font-weight: bold;">resume
button </span>to resume the application. </li>
  <li> In the variable view:
    <ul>
      <li>Press <b>Show Type Names</b> to show the type of each variable</li>
      <li>Check <span style="font-weight: bold;">Show Constants</span>
to display constants, check <span style="font-weight: bold;">Show Class
Variables</span> to display class variables<br>
      </li>
    </ul>
In the screenshot above the java debug actions are disabled, so that
only the ruby debug commands <b>Show Constants</b> and <b>Show Class
Variables</b> appear. If you want to disable/enable either ruby or java
debug actions, go to<b>Window &gt; Preferences &gt; Debug &gt; Debug
Action Groups</b> and select the appropriate debug actions. </li>
</ol>
<h2>Variable View</h2>
The variable view shows instance variables, class variables and
constants of objects. Arrays and hashes are handeled specially.
<h3>Arrays</h3>
Assume the following code:
<pre>class Person<br>    def initialize(name) <br>         @name = name<br>    end	<br>    def to_s()<br>       return @name.to_s<br>    end	<br>end<br><br>persons = []<br>persons &lt;&lt; Person.new('Barney') <br>persons &lt;&lt; Person.new('Moe')<br></pre>
After the last assignment the variable view shows the content of the
array:<br>
<img src="../../images/arrayInVariablesView.png"
 title="array presentation in variable view"
 alt="array presentation in variable view"
 style="width: 500px; height: 235px;">
<h4>Hashes</h4>
In order to show how hashes are presented in the variables view, a hash
is created:
<pre>persons = Hash[ Person.new('Lisa') =&gt; Person.new('Marge'), <br>                     Person.new('Maggie') =&gt; Person.new('Marge')]<br></pre>
The view shows the name of the hash with the number of elements in the
first place. If you expand the item, there will be a line for every
key/value pair in the hash. Expanding a key/value pair will show the
content of the value. If you want to know more about the key, select
"Inspect key" from the context menu:<br>
<img src="../../images/hashInVariablesView.png"
 title="Hash in variables view" alt="Hash in variables view"
 style="width: 501px; height: 215px;"><br>
<h2>Breakpoints View</h2>
<h2>Expression View</h2>
Results of ruby expression evaluation are displayed here. Evaluation
takes place:
<ul>
  <li>If you select text in the editor and run "Inspect" from the
context menu</li>
  <li>If you use the display view to enter ruby expressions</li>
  <li>If you select "inspect key" in the context menu of a hash value
in the variable view</li>
</ul>
<h2>Display View</h2>
Enter your text in the display view and run "Ruby inspect" from the
context menu. The expression view will open and show the result of the
expression. The expression is evalutated in the context of the selected
stack frame in the launch view.
<h1>Known limitations</h1>
<p>The ruby debugger is still under development and there are some
limitations, which must be considered when debugging your application:<br>
<br>
</p>
<ul>
  <li>In order to get the debug information about the running program,
eclipse starts a ruby debugger before       the execution of your
application and talks to that ruby debugger via socket. Currently this
socket is       set to 1098 and if this socket is bound already
debugging is not possible. (The java debugger searches       for a free
socket before; that behaviour should be implemented for the ruby
debugger as well)</li>
  <li>threads are not refreshed regularly, i.e. you do not see the
threads your application creates before a       breakpoint (or exception
or end of step) is reached</li>
  <li>Only one ruby program can be debugged concurrently (there is a
socket bind exception if you try to debug more than    on ruby program
at the same time)</li>
  <li>breakpoints are not saved when eclipse is closed</li>
</ul>
<h1>Writing Bug Reports</h1>
<p>In order to provide useful information in case of errors, you should
turn on verbose mode for the ruby debugger:</p>
<ul>
  <li>open file
ECLIPSE_HOME/plugins/org.rubypeople.rdt.launching/ruby/eclipseDebug.rb</li>
  <li>set ECLIPSE_VERBOSE = true</li>
  <li>save file</li>
  <li>After you started debugging, the console shows additional
information (appears red, if stderr is printed red): <img
 src="../../images/verboseConsole.png" title=""
 alt="verbose debug information in console"
 style="width: 758px; height: 231px;"></li>
  <li>go to <a href="http://sourceforge.net/projects/rubyeclipse">http://sourceforge.net/projects/rubyeclipse</a>
and add the console input to your bug report.</li>
</ul>
</body>
</html>
